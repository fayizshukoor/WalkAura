<div class="flex items-center justify-center min-h-[calc(100vh-160px)] py-12 px-4 sm:px-6 lg:px-8 bg-black">
  
  <div class="w-full max-w-md space-y-8 bg-[#18181b] p-10 rounded-2xl border border-gray-800 shadow-2xl">
    
    <div class="text-center">
      <h2 class="text-3xl font-extrabold text-white tracking-tight">
        Set New Password
      </h2>
      <p class="mt-2 text-sm text-gray-400">
        Your new password must be different from previous used passwords.
      </p>
    </div>

    <form class="mt-8 space-y-6" action="/update-password" method="POST" id="passwordForm">
      
      <div class="space-y-2">
        <label for="password" class="block text-sm font-medium text-gray-300">
          New Password
        </label>
        <div class="relative rounded-md shadow-sm">
          <input 
            id="password" 
            name="password" 
            type="password" 
            required 
            placeholder="Enter your new password"
            class="block w-full rounded-lg border border-gray-700 bg-[#27272a] text-white placeholder-gray-500 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-3 pl-4 pr-10 transition duration-200 ease-in-out"
          >
          <button type="button" onclick="toggleVisibility('password', 'eye-icon-1')" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-white focus:outline-none">
            <svg id="eye-icon-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </button>
        </div>
        <p id="length-message" class="text-xs text-red-500 hidden mt-1">
          Password must be at least 6 characters long.
        </p>
        <p class="text-xs text-gray-500 mt-1">
          Minimum 6 characters.
        </p>
      </div>

      <div class="space-y-2">
        <label for="confirm-password" class="block text-sm font-medium text-gray-300">
          Confirm New Password
        </label>
        <div class="relative rounded-md shadow-sm">
          <input 
            id="confirm-password" 
            name="confirm-password" 
            type="password" 
            required 
            placeholder="Confirm your new password"
            class="block w-full rounded-lg border border-gray-700 bg-[#27272a] text-white placeholder-gray-500 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-3 pl-4 pr-10 transition duration-200 ease-in-out"
          >
          <button type="button" onclick="toggleVisibility('confirm-password', 'eye-icon-2')" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-white focus:outline-none">
            <svg id="eye-icon-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </button>
        </div>
        <p id="match-message" class="text-xs text-red-500 hidden mt-1">
          Passwords do not match.
        </p>
      </div>

      <div>
        <button 
          type="submit" 
          class="group relative flex w-full justify-center rounded-lg bg-indigo-600 px-4 py-3 text-sm font-semibold text-white hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 shadow-lg shadow-indigo-500/30"
        >
          Reset Password
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  // 1. Toggle Visibility (Same as before)
  function toggleVisibility(inputId, iconId) {
    const input = document.getElementById(inputId);
    const icon = document.getElementById(iconId);
    
    if (input.type === "password") {
      input.type = "text";
      icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />`;
    } else {
      input.type = "password";
      icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />`;
    }
  }

  // Variables
  const form = document.getElementById('passwordForm');
  const password = document.getElementById('password');
  const confirmPassword = document.getElementById('confirm-password');
  const matchMessage = document.getElementById('match-message');
  const lengthMessage = document.getElementById('length-message');

  // Helper functions to manage styles
  const showError = (input, messageElement) => {
    messageElement.classList.remove('hidden');
    input.classList.add('border-red-500', 'focus:border-red-500', 'focus:ring-red-500');
    input.classList.remove('border-gray-700', 'focus:border-indigo-500', 'focus:ring-indigo-500');
  };

  const clearError = (input, messageElement) => {
    messageElement.classList.add('hidden');
    input.classList.remove('border-red-500', 'focus:border-red-500', 'focus:ring-red-500');
    input.classList.add('border-gray-700', 'focus:border-indigo-500', 'focus:ring-indigo-500');
  };

  // 2. Length Validation Logic
  password.addEventListener('input', () => {
    if (password.value.length > 0 && password.value.length < 6) {
      showError(password, lengthMessage);
    } else {
      clearError(password, lengthMessage);
    }
    // Also re-check match if user changes main password
    if(confirmPassword.value) checkMatch(); 
  });

  // 3. Match Validation Logic
  const checkMatch = () => {
    if (confirmPassword.value && password.value !== confirmPassword.value) {
      showError(confirmPassword, matchMessage);
      return false; // Mismatch
    } else {
      clearError(confirmPassword, matchMessage);
      return true; // Match
    }
  };

  confirmPassword.addEventListener('input', checkMatch);

  // 4. Form Submit Prevention
  form.addEventListener('submit', (e) => {
    let isValid = true;

    // Check Length
    if (password.value.length < 6) {
      showError(password, lengthMessage);
      isValid = false;
    }

    // Check Match
    if (password.value !== confirmPassword.value) {
      showError(confirmPassword, matchMessage);
      isValid = false;
    }

    if (!isValid) {
      e.preventDefault(); // Stop form submission
    }
  });
</script>